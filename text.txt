1.35 0 BSERVATION. Every graph contains a basic maximum 2-matching.
In fact, the following slightly stronger assertion holds.
 
[
1.36 OBSERVATION. Let G be a graph and let 'au E E(G) lie in some maximum 2-matching of G (i.e., it mceives a non-zero value). Thm, ut, lies in a basic maximum 2-matching.
 
PROOF. It suffices to prove that u?! is not an even indexed edge in a path consisting of an odd
number edges all of weight 1; for if so the above operations by which a basic 2-matching can be
attained from the maximum 2-matching containing v all preserve mi.
Suppose then that uu does form an even-indexed edge of such an odd path. Then, the
operation defined above for paths generates a heavier -mat things than the one containing uv;
contradiction.	•
By a 2-cover of a graph G, we mean an assignment	V(G)	{0,1,2} such that
e(u)	(v)
whenever uv E E(G). The size of also denoted lek is given by
= E e(v).
The size of a. minimum 2-cover is denoted by 72(G). Assigning each vertex the value 1 defines a.
2-cover so that 1-2(G) < v(G) holds trivially.
The multi-union of any two vertex-covers of G (common vertices appearing twice) forms a
2-cover. Hence, 7-2(G) < 2T(G). A 2-cover is said to be basic if every component of the graph
induced by the vertices of weight 1 is not bipartite. Given a bipartite component in the latter
in	subgraph, assigning the value 2 to all its vertices in its smaller side if there is no smaller
side any side will do) and 0 to all vertices on the other side generates a smaller 2-cover with the
aforementioned component no longer present in the subgraph induced by vertices with weight 1,
it follows, that every graph admits a basic minimum 2-cover.
The set X c V(G) of vertices assigned the weight 0 in a 2-cover e is independent. If there
exist a vertex .v with ,(v) = 2 satisfying NG(v) fl	= 0, then (11) > 1 for every u c NG(v)
so we may lower the weight of v to 1 and generate a smaller 2-cover. Consequently, if is a.
minimum 2-cover all vertices v satisfying J_VG(v) 11X = 0 must have weight I.
Conversely, if X C VW) is an arbitrary independent set of G, then assigning 0 to the
members of X, 2 to the members of NG(X) := {7,1 E 1/(G) \ X : 37) E X, UV E E(G)}, and 1 to
all others results in a 2-cover. We write x to denote the latter 2-cover and say that it is the
2-cover generated by X. We have just established the following.
1.37 LEMMA, Every minimum 2-cover of a graph Cis the 2-cover .generated by its vertices
of weight 0. In particular,
(G) = min	— I X	I y T	I	G), % is independent} .
J 
The following is the main result of this section.
 
1.38 KoNIG" 'S THEOREM FOR 2-MATCHINGS. For any graph C, v2(G) =1-2(G).
PRooF. Given a graph C, define B to be an auxiliary bipartite graph obtained as follows from
G.
•	Replace every vertex v C VW) with two new vertices namely t/ and v".
•	For every original edge 'ay C E(G), define the edges u'v" and ullui in B.
The theorem follows from Konigus theorem and the following two assertions proved below.
112(G) = v(B) and r2(G) = T.
We start by proving that v2(G) = v(B). Let AT be a maximum matching in B. We construct
a 2-matching G by setting
euv) =A fl ufv" u"vi}
for every edge UV E E(G). This establishes that 1/2(G) > LIP).
Second, let 1/5 : E(G)	0,1,2} he a maximum 2-matching of G. By Observation 1.35, we
may assume IP is basic; as such its edges of weight 2 are independent from all other non-zero
valued edges and the edges of weight one are at	in vertex disjoint odd cycles. Define a set
Al C E(B) as follows.
•	If 0(uv) .= 2, then include both Wu" and u"1/ in M.
•	If C := {vi,... v7-1 is an odd cycle comprised of edges of weight 1, include the edges
'1	VA In.
The set Al forms a. matching in B of size
The assertion that 7-2 (G) = r(B) is left to the reader.	1
§ 1.7. ENVY-FREE MATCHINGS
The problem in which resource8 populate preference lists of given agents upon which one
seeks to efficiently find an assignment of agents to resources in a manner that would be deemed
stable, is a veteran problem arising in many fields. Variants of this problem arising from economy
and in particular from the so called fiiir-division problems introduce yet no	aspect of the
problem, and that being envy. Roughly speaking, one seeks an assignment in which agents do
not envy other agents along the proposed assignment. There are several forms of envy one would
like to guard against. In this manuscript, we seek to find assignments which are free of envy
being generated by agents not assigned any resources on yet having some of the resources found
on their preference lists assigned to someone else.
 
1.39 DEFINITION. Let G := (X LJ Y, E) be a bipartite graph. A matching Ai C E is said
to be envy-free w.r.t. X if even!) vertex in X \ X m is not adjacent to any vertex in Ym .
 

 
Throughout, all envy-free matchings are taken w.r.t. X. Moreover, as isolated vertices, in either
part of the bipartition, play no role w.r.t. envy-free matchings, all bipartite graphs henceforth
are assumed to have no such vertices and such an assumption is without loss of generality.
The empty matching is trivially envy-free; as are perfect matchings , if these exist in the graph.
Arbitrary bipartite graphs, however, do not necessarily admit non-trivial such matchings though.
 
The family of bipartite graphs without such matchings is quite rich. The canonical examples
being the complete imbalanced bipartite graphs Km., with m > 77, and P
2k-F1 - the simple path
with 2k + I. vertices - with k > 1, where in both examples we identify X with the larger class in
the bipartition. The Trt-blow-ups (by that we mean the replacement of vertices with independent
set of size m and edges with copies of K,,,,) of P2k+1 and K1 a. also do not admit non-trivial
envy-free matchings. Bipartite graphs containing any of these exemplary graphs as spanning
sub graphs also do not contain non-trivial envy-free matchings (see Corollary 1.44 for accurate
details).
Nevertheless, in this section we prove an efficient characterisation for the bipartite graphs
admitting a non-trivial envy-free matching, and moreover provide efficient algorithms for finding
a maximum carclinality and maximum weight env-free matchings in an arbitrary bipartite graph.
All forthcoming algorithmic results revolve around the notion of enclosure. By an enclosure in
G, we mean a. (vertex-induced) subgraph S C G satisfying N C E(S) whenever N is a non-trivial
envy-free matching in G. An enclosure is termed saturated if it admits a matching saturating its
X-part. It is called isolated if there are no edges in G between the Y-part of the enclosure and
the .-part of the rest of a The main (technical) result of this section reads as follows.
 
[ 1.40 PROPOSITION. An encloswre of a bipartite C:= (V, E)) can be efficiently computed
 

 
Given a maximum matching Al in GI, an M_ enclosure is the subgraph of G induced by the
vertices not reachable from X \ 17(11,1) via an AI-alternating path (see § ?? for a definition).
In § 1.7.1, we prove that the notions of isolated saturated enclosure and Al-enclosure do in fact
coincide in the following sense. If G admits a Y-saturating matching, then we prove that G
admits a unique isolated saturated enclosure for indeed ranging over all maximum matchings
of G all of their associated M-enclosures coincide and yield the same vertex-induced subgraph
of C that in turn forms an isolated saturated enclosure. In the complementary case, that C
does riot. admit a Y-saturating matching, uniqueness of isolated saturated enclosures in such a
strong sense is indeed lost, but only due to the triviality that the set Y V(M) may differ across
different maximum matchings M. Nevertheless, as far as envy-free matchings are concerned this
loss of uniqueness is insignificant as ranging over all maximum mat things of G, all M-enclosures
of G coincide on their )-part which will suffice for our needs.
The next, main result of this section reads as follows.
1.41 PROPOSITION. A bipartite C:= (X Y, E) admits a non-trivial envy-free matching
(w.r.t. X) if and only if it admits a, non-empty isolated saturated enclosure. Moreover, C
admits no matching saturating Y , then G admits a non-trivial envy-free matching (w.r.t.
X ).
	J
If X I< 1171, then C does not admit a Y-saturating matching, and thus by Proposition 1.41,
C admits a non-trivial envy-free matching. This carries the economic message that as soon
as resources in which there is interest by at least one agent) outnumber the agents (that are
interested in at least one resource), then a non-trivial envy-free assignment is possible. Observe
now, that all examples presented above for bipartite graphs admitting no non-trivial envy-free
matching satisfy 12X-1 > Ir and have a. Y-saturating matching.
Proposition 1.41 trivially implies that,
if 11r(3.(X) > XI > 1 then G admits a non-trivial envy-free matching.	(1.6)
 
Our interest in this sufficient condition is as follows. First, it serves as a relaxation of the
well-known Hall condition [28] (see (1.2)) fitting for non-trivial envy-free matchings. Second, (1.6)
implies a result of Kilun [41, Page 3-1] asserting that if there is a vertex x E X satisfying
NG(X) = then a non-trivial envy-free matching exists and can be efficiently found; Khun used
his result in the context of the so called fair eake-cutting problem_ (which we shall not detail
here
With the characterisation of bipartite graphs admitting non-trivial envy-free matchings
settled, we proceed t optimisation and prove the following.
1.42 T H () R M . Let G	(X y,	be. a bipartite graph on, n, )ertics and In edges.
(1) An envy-free matching of maximum cardinality can, be found within 0(m,VT-z) time.
(ii) If in addition C is endowed with a function w E R>o, then an envy-free matching
of maximum weight can be found within 0(mn + n2 to n) time.
The applicative intuition underlying the optimisation problems of Theorem 1.42 are clear and
natural. Note also that the best known time complexity for finding a. maximum matching in an
arbitrary bipartite graph on n vertices and edges is 0(m Nrrt) and is attained using the classical
algorithm of Hoperoft and Karp [32]. We attain the same time-complexity for our maximum
cardinality problem.
While not appearing under this name or in a. gTaph-theoretic terminology as we have here,
envy--free matchings as a. concept have appeared in the literature pertaining to various so called
fair-division problems. The aforementioned result of Kuhn [41, Page 31], for instance, appeared
in matrical notation. Providing rigorous treatment for the concept of envy-free matchings and
supplying standalone algorithms for the decision problem, maximum cardinality problem, and
maximum weight problem serves to facilitate researchers tackling fair-division problems.
1.7.1 Enclosures
Let C := (X jy, E) be a bipartite graph (admitting no isolated vertices) with m edges and
n vertices. In this section, we prove that any G admits a (possibly empty) saturated isolated
segregation and that the latter is computable within0(711\111) time. Moreover, if G admits a
Y-saturating matching then such a segregation is in fact unique.
1.7.1.1 Upward inheritance of non-cnvyfreeness
The main result of this section is Corollary 1.44 which to a certain extent asserts that the
trait of a graph admitting no non-trivial envy-free matchings is inherited by its supergraphs.
1.43 LEMMA . Let G := (X Li E) be a bipartite graph. Let Fl := (X Lill-, E') be a spanning
subgraph of C	E' c E) admitting a Y -saturating matching. Then, for every envy-free
matching in G, there exists an envy-free Triatching of the same cardinality in H.
_
PROOF. Let M be a matching saturating Y in H and let N be an envy-free matching in G.
Trivially, YAT C Y is saturated by M. Then, every vertex x E NAB (YN C XA.1 must be saturated
by N, for otherwise x is envious of some member of XN over the singleton Arm( Ix ) It. follows,
that Nm(YAT) C XN As NIT (YN) and XN are both perfectly matched to l'N, the former by _AI
and the latter by N, INm(YA1)1= IYAri =IXN1 holds, implying that Xm = XN in fact holds.
Let C M be the sub-matching of Al induced by YN and NA4 YN XN . Then V(L) = V(N)
and LCMC H. Envy-freeness of N in C asserts that eG(X	YN) = This coupled with
the fact that V(L) _ V(N) implies that L C H is envy-free as required.	•
For future reference, the following formulation will be more convenient for us.
1.44 COROLLARY. If H	(X LI.] Y, E') is a bipartite ,giraph admitting a Y -saturating
matching yet MO non-trivial envy-free matching then any bipartite C := (X Lair E) containing
H as a spanning subgraph	C E } does YZ o I admit a non-trivial envy-free matching.
Implicit in the proof of Lemma 1.43, is that any non-trivial envy-free matching N admits no
N-augmenting paths meeting N, giving rise to the impression that there should be some clear tie
between maximum matchings and non-trivial envy-free matchings. Nevertheless, ample examples
have by now been presented in which this is not the case. For indeed, unlike maximum matchings
Al which by Berge's theorem, namely Theorem 1.23, disqualify all M-augmenting paths whether
these meet Al or not envy-free matchings differ in that these disqualify- alternating paths that
need not h augmenting and meet their edges) as well.
1.7.1.2 Alternating sequences
The purpose of this section is to introduce a structure called an alternating sequence that is
efficiently computable with which one can flush out segregations.
Given a sequence of sets Z := (4,	Z1) and two natural numbers i < j we write
:=	Zk.

whenever i < < < j. If — i and jt = j we write UZ instead.
Let G admit no matching saturating X and let Ai be a maximum matching in G. Given an
arbitrary set 0 Al C \Xm we define a pair of sequences (A, B) as follows. Set B1 := NG(A1).
Then given (Ai,	, Ai) and (B1, ... Bi) for sonic i > 1 set.
At±i :=	_Nm(Bi) and Bi±i :=	NG(Ai±i)	Bi.	(1.7)

j=1
Then,
any vertex b E	must be matched in M to a vertex in X \	Aj.	(1.8)
Indeed, for otherwise, as b cannot be matched to any vertex inUji_i Aj by definition it follows
then that such a vertex lies on an AI-augmenting path of the form Bi — — a — B1 — Ai in
contradiction to the maximality of M by Berge's theorem, namely Theorem 1.23.
Property (1k8) then implies that if a non-empty Bi is defined by the process then a. non-empty
Ai+1 is defined by it. Consequently, such an ensemble is said to be maximal if its next B-set is
empty and thus not defined by the process. In particular,

a maximal ensemble (A, B) has the form A = (A1, , Ai) and B = (B1, ... B,_1)
for some i > 1	(1.9)
 
Given a non-X-saturating mwdmum matching Al in G (assuming one exists) and an initial set
Ai C \ VW), we write S(M, Al) to denote a, maximal ensemble built along (I_.7) starting
from 1 a.nd refer to it as an - al Kati sequence starting  a	1.
Let X0 := X Xm and set S(M,X()) := (X, y), where X := (X0, Xi,	Xk) and y
Yo. Set II(X, y) to be the subgraph of G induced by the edges used to define Scitl, X0).
Note that the decomposition (ilX, X \ ilX,U)),	lly) arising from Spl, X0) is akin to the
so called Dulmage-Mendelsohn decomposition; the latter however is not as convenient for our
pursuit of envy-freeness.
I 1.45 LEMMA il (X, Y) admits no non-trivial envy-free matching.
PRooF. We may assume that II := H(X, y) is non-empty for otherwise the claim holds
vacuously. Fm' suppose that H were to admit such a matching, namely N. Either there exists an
.i c 10,	k —1} such that. N has an edge of the form xiyi±i with xi c X, and yi±i c Yi+i or no
edge in N is of that form. In the former case let, P := lxi,	,yE,xt} be a maximal
N-alternating pathi riH satisfying xi E X and yj E Yi where i < < e < k; such a path clearly
exists as the existence of yi+l implies that xi+1 E Nm(yi+i) lies in Xj+i, To avoid envy along
P all X-vertices in P must be saturated by N. Note however that owing to the m_aximality
of P the vertex :r.e cannot be saturated by N as by the definition of H there is a unique edge,
namely xf.m9_, that can be used to saturate it. The alternation of P starting from the skewed edge
xiyi+i c N is such that zoi cannot be used to saturate xe.
In the complementary case, all edges in N are of the form xiyi with Ic [k]; so that in
particular no member of Xo is saturated by IV. Let then i [Id be the smallest index such that
N n EH (X4, Yi) 0. As every j E [Id has the property that NH (Y-j) n xj-1.	it. follows that
in this case X() ha:s vertices envious of vertices saturated by N; a contradiction.
1.7.1.3 Isolated saturated enclosures
If C admits a. matching saturating X then G serves as the required enclosure. Suppose
that G admits no such matching and let M be a matching of maximum cardinality in G. Let
X0 :=x XM and set SIM, X0) := (X, y), where X := (X0, Xi,	Xk) and J) :=	Yk).
Put XL := X\ L.JX and YL :=	Li)). By (1.8), no member of 17 Ym lies in uy. Consequently,
(Y Ym) Nm(XL). Members of Y Kg cannot be adjacent to members of LiX, for then
members of the former would reside in U)) contradicting (1.8). This coupled with the assumption
that G admits no isolated vertices mandates that
Ym	only if XL,	(1.10)
Owing to the maximality of the ensemble (X, y), eGNX,Nm(x,y)(L(X, y))) = l holds whether
XL is empty or not. Coupling this with eG(LJX,Y Ym) 0, already observed, leads to
By definition, G[XL, Yid] is the M-enclosure of G. In fact, much_ more is true.
[
1.46 LEMMA . G[XL, Yij forms an isolated saturated enclosure of G (which might be empty).
22
 
PROOF. Suppose that G[XL , Yid is non-empty. Isolation of G[XL, Yd follows from (1.11).
The fact that GL{XL, Yid] is saturated is also clear; for indeed, by definition of S(Al, X0), the
(non-empty) set Em [XL, I'] forms a. matching in G[XL„ YL] saturating XL in C[XL, Yd. It
remains to prove that G[XL, YL] forms an enclosure. Suffice to prove that no non-trivial envy-free
matching saturates a member of UX or of uy.
By Lemma 1.45, (X , y) admits no non-trivial envy-free matching. As Ii(X, ,y) admits a
matching saturating its Y-part, it follows, by Corollary 1.44, that owing to H(X„ y) being a
spanning subgraph of G[UX, i_.011 that the latter admits no non-trivial envy-free matching. This
in turn implies that in fact
N E(G[ux, y]	holds,	(1.12)
whenever N is a non-trivial envy-free matching in G. To see (1.12) not first that if XL = then
= 0, by (1.10), leading to G and G[ilX, um coinciding; rendering (1.12) trivially true.
Assume then that XL 0 and let N be a non-trivial envy-free matching of C violating (1.12).
Then, owing to eG(iltki, YL) = 0, N E(G[UX, UM) is envy-free in G and in G[uX, uy] in
particular.
0-wing to (1.11), to conclude it remains to prove that
N n EG(xL, uy) = holds	 

whenever N is a non-trivial envy-free matching of G. For suppose otherwise, and let. c = xy E N
satisfy x e XL and y E Li)). As in 11(x y) the vertex y is adjacent to a vertex x' E LJX (through
M) then in order to resolve the potential envy of Lein x, N must saturate x'. As eG(UX„ L. = 0„
saturation of x' by N must employ edges from E(G[uX. u))]) contradicting (1.12).	■
/—
1.47 OBSERVATION. If G admits a 3 T -saturating matching then G admits a unique isolated
saturated enclosure.
Pito0F, If G admits no non-empty enclosures the claim follow. Suppose then that G admits non
empty enclosures and let Al and Alf he two distinct maximum matchings in C; by assumptim
= 0 =	Y11,11 a Let G[ XT,,	and G[X;j, II] be the (saturated) AI-enclosure and
Mr-enclosure associated with M and AV, respectively. These, by Lemma -1.46, both form isolated
saturated enclosures of G. The former admits an envy-free matching saturating XL and the latter
admits an envy-free matching saturating _VI,. As enclosures bydefinition contain all envy-free
matching both sets XL arid _JCL must be contained in one another and thus coincide. The same
applies for the sets Yid and 11.
The above establishes that all isolated saturated enclosures that can be constructed as above
using maximum matchings coincide into a single such structure. It remains to account for
all potential such enclosures that may not he constructed as described above using maximum
matchings (or perhaps may not, be efficiently attainable). The totality of enclosures, however,
together with Lemma 1.45 renders this a triviality.	■
Put another way, if G admits a. Y-saturating matching, the same isolated saturated enclosure
will be attained regardless of the maximum matching used to construct the ensemble S(111, X0)
as defined above. If G does not admit a Y-saturating matching then indeed uniqueness in this
strong sense is lost. as Y \-11-m may differ as one ranges over all maximum matchings M of G.
Nevertheless, the type of enclosure discovered is uniform across all maximum matchings in the
following sense.
 
1.48 co ROL LA RI'. All isolated saturated enclosures of a bipartite C have the same X -part.
 

 
PROOF. As seen in the proof of Observation 1.47, we only need care about enclosures that
can be constructed using maximum matchings as detailed above. If G admits a Y-saturating
matching, the claim follows from. Observation 1.47 If C admits no Y-saturating matching, then
given any two Al-enclosure G[XL, /FL] and IW-enclosure G[X'L, Y1], then both XL and JCL are
saturated by envy-free matchings and thus must coincide as both G[XL, YL] and G[XL	are
enclosures, by Lemma 1.46.
	Ym 0 for every maximum matching Al, which, by (1.10), can only happen if XL, /	
	
for every maximum matching M , where here XL, is the set defined above associated with Al. If
the set XI, 0 then a non-empty saturated segregation is defined; as this holds for all maximum
matchings M the claim follows.	•
Put another way, either all maximum matchings give rise to an empty enclosure or all give rise
to a non-empty isolated saturated enclosure.
1,7.2 Algorithms for finding envy-free matehings
In this section we prove Proposition_ 1.41 and Theorem 1.42. We start with the former.
PROOF OF PROPOSITION 1.41. In view of § 1,7.1, the assertion that a bipartite G admits
non-trivial envy-free matchings if and only if G admits a non-empty isolated saturated segregation
is by now clear. It remains to argue that C admits a. non-trivial envy-free matching whenever it
admits no Y-saturating matching.
In which case Y Ym 0 for every maximum matching Al, which, by (1.10), can only
happen if Xi, 0 for every _maximum matching M. The set XL being non-empty implies that a
non-empty isolated saturated enclosure exists in C; any matching in this enclosure saturating its
X- part defines an envy-free matching in G.	•
We proceed to proving part (1) of Theorem 1.42 asserting that an envy-free matching of
maximum cardinality can be found within 0(7.11), where 7n is the number of edges and n is the
number of vertices in G. This assertion is a direct consequence of Lemma 1.46 and Corollary 1.48
-where the former outlines the algorithm and the latter justifies our ability to start the algorithm
from an arbitrary maximum matching. The algorithm these two assertions imply can be seen in
Algorithm 1.7.3.
Algorithm 1.7.3. Finding envy-free matchings of maximum cardinality
INPUT: A bipartite graph G := (X L.J 1/-7
OUTPUT: An envy-free matching of maximum cardinality.
1:	Let Al be a matching of maximum cardinality in G.
2:	CompUte the (possibly empty) isolated saturated segregation G[XL,
3:	Return M n E(C[XL, Yd.
It remains to prove part (ii) of Theorem 1.42; asserting that if C is endowed with an edge-
weighting function w E R>0 then an envy-free matching of maximum weight can be found
within 0(rnn + n2 to n) time. We start with the following observation.
1- 1.49 oBsER. VATTON. Let C := (X U Y, E) be bipartite graph admitting an X-saturating matching. Let N be an, envy-free matching in G. Then, N is contained in some X -saturating
 

 
matching.
PROOF. Let Al be an X-saturating matching in C and put MN := {(x, Nm(x)) x E X \ XN}.
Envy-freeness of IV mandates that Nm(x) is no saturated by N for every x E \ X. Hence,
N MN is an X-saturating matching containing N.
For G admitting an X-saturating matching and endowed with an edge weighting function
w E R>o, Observation 1.49 reduces the problem of finding an envy-free of maximum weight
in G to that of finding an X-saturating matching of maximum weight. The latter is a veteran
problem known as the assignment problem which reads as follows.
The unbalanced assignment problem. Let C := (X L.] Y, E) be a bipartite graph (with
possible) endowed with an edge-weighting function w : E	. Let t > 1 be an integer.
Amongst all matchingsiiiG of size s min{ v(G) I find one of maximum weight , where here
v (G) denote the size of a maximum (cardinality) matching in G.
For the assignment problem whether the graph is assumed balanced (i.e., _/Y] = Y ) or
not effects the time-complexity of the algorithms greatly. The canonical algorithm solving the
balanced assignment problem is the so called weighted Hungarian method put forth by Kuhn [40]
(see [58, Chapter 17] also though not with the best time-complexity. Various improvements to
Kuhn's result in the balanced case as well as other variants can be seen in [23, 21, 26, 50, 52, 59],
For our needs though the unbalanced version is of interest. Here too there is a long list of
result partially contained in the aforementioned results. For the unbalanced version though
the time-complexity record belongs to Ramshaw and Tarjan [52] who attain a running time of
0(ms s2 log(min IX	where s is per the definition of the problem above. In subsequent
arguments we shall apply an algoritinn for the unbalanced assignment problem to bipartite
graphs G := (X UY, E) admitting an X-saturating matching so that v(G)= IX] = t and thus
for us s = 72, suffices. This together with Observation 1.49 yield the following.
1.50 PROPOSITION. Let C	(X Li if, E) be a bipartite graph on in edges and rt
vertices admitting an X-saturating matchin9 and endowed with an edge-weighting function
to E R>0. Then a maximum-weight envy-free matching (w.r.t. X ) G can be found
within, 0 (m,ri 7-12 log n) time.
We are now ready to prove part (ii) of Theorem 1.42.
PROOF OF PART (II) OF THEOREM 1.42. In a manner similar to the proof of part (i) of
this theorem, let M be a. maximum matching in C and let G[XL UYid be the (possibly empty)
isolated saturated segregation associated with Al as described in § 1.7.1.3. Apply the algorithm
of Proposition 1.50 to CPC", LiYL1 and return its answer. This leads to Algorithm 1.7.4.
Algorithm 1.7.4. Finding envy-free m_atchings of maximum weight
INPUT; A bipartite graph C (X iY. E) and a function w E R>0.
OuTPUT: All envy-free matching of maximum weight.
1:	Let ill be a matching of maximum cardinality in G.
2:	Compute the (possibly empty) isolated saturated segregation G[Xr,, YL]
3:	Apply the algorithm of Proposition 1.50 to G[XL, YE] and return its answer.
25
1.73 Generalisations and extensions of envy-free Triatehings
Exte-nsions and generalisations for envy-free matchings abound. The following extension
arises quite naturally. Let C := (X: L_J Y, E) be a bipartite graph and let r E N. By an r-s-tar
matching (w.r.t. X) we mean a set of vertex disjoint copies of .K1,7- (i.e., the T.-star) with all
star centres found in X and all star leaves in Y, for every r-star in the matching. An envy-free
r-star matching w.r.t. X is then an r-star matching with the property that every vertex in X
not present (as a centric) in any r-star in the star-matching is not adjacent to any vertex y G
that. lies in the leaves of any ,r-star defined by the matching.
[1.51 PROP OSI TI ON. Given a bipartite graph G := (X L) Y, E) and a ed integer r E N (independent of the order of the graph), then an envy-free r-star matching in C co be found in polynomial time.
PROOF. Given GI, construct the following auxiliary bipartite graph C' := (Xf Y, g) attained
from C by duplicating every vertex in X 'T.-times (letting X' denote the resulting set of vertices).
Each copy I), of x E X is connected to every vertex in NG(x) by and edge and this defines
Let two envy-free matchings in G' be called equivalent if for every x E X these have the same
number of edges between fvf, ,vn and NG(x) C r. This defines an equivalence relation,
namely TZ, On the envy-free matching f G.
We prove that there is a 1-to-1 correspondence between the envy-free r-star rnatchings of C
and the equivalence classes of R. With such a correspondence established the claim follows by
applying Algorithm 1.7.3 to C' and translating the attained matching back to G as to form the
required star-matching. We now make our claim regarding the correspondence precise.
To establish the aforementioned correspondence, let, first, an envy-free v-star matching N in
C be given. Then the set of matchings attained from N in Q1 by replacing the centre x E X of
each v-star S in N and matching its r copies of x in X' to the leaves of S in an arbitrary fashion,
are all envy-free and equivalent under 7?,.
Conversely, let 1‘11 he an envy-free matching in Gf (viewed as a. representative of its class in
70. As C[fvf,	7)TII,NG(X)1 forms a complete bipartite graph, then if (iii y) E Ni forsome
C Fr], then _Ar' being envy-free in Gr' means that N' must saturate all of Ivf,	lip or none at
all in case that > degG(x). If saturated, then_ all these vertices can only be saturated by_All
in edges with one end in NG(x); all edges thus used by N' in Grn correspond to different
edges in C whose one end is x (the ends in Y are distinct). Collapsing every set (vf,
saturated by Ar' back to its origin x in C gives an envy-free T.-star matching in G.
The proof of Proposition 1.51 also establishes that
If 1-1VG(X)1 > r IX1 > 1, then G contains a. nonempty envy-free r-star matching.
This is then an extension of the Hall-type sufficient condition fitting for envy-free matching
seen at (1.41). The latter Hall-type sufficient condition for env-free r-star matchings extends
aforementioned result of Khun [41, Page 31] even further.
For non-bipartite graphs the canonical generalisation of envy-free matchings studied here
is trivial. Indeed, the lack of a bipartition leads to one defining an envy-free matching in an
arbitrary graph as a matching in which no matched vertex is adjacent to any matched vertex.
This degenerates the problem completely. For indeed under the new definition a connected graph
admits an envy-free matching if and only if it admits a. perfect matching. Then an arbitrary
graph admits a non-trivial envy-free matching (under this new definition) if and only if it has
